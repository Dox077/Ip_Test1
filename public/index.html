<!DOCTYPE html>
<html>
<head>
  <title>Fix Error: Cannot read properties of undefined (reading 'spreadsheets')</title>
  <script src="https://apis.google.com/js/client.js?onload=googleApiClientReady"></script>
  <script type="text/javascript">
    // Declare a global variable to store the Google Sheets API client.
    var client;

    // Initialize the Google Sheets API client when the page loads.
    function googleApiClientReady() {
      if (google.sheets) {
        client = new google.sheets.Client();
      } else {
        // The Google Sheets API is not loaded.
        console.log("Error: The Google Sheets API is not loaded.");
      }
    }

    // Use the Google Sheets API client.
    function useGoogleSheetsAPI() {
      // Make a request to the Google Sheets API.
      client.spreadsheets.values.append({
        spreadsheetId: "1UDDarsUSFfdEhALQUlPvONklLpR0jzeV5kTaJ6Nslr4",
        range: "A1",
        valueInputOption: "USER_ENTERED",
        values: [["Name", "Email"]]
      }).then(function(response) {
        // The request was successful.
        console.log("Request successful.");
      }).catch(function(error) {
        // An error occurred.
        console.log(error);
      });
    }

    // Call the Google Sheets API client when the page loads.
    window.onload = function() {
      if (client) {
        useGoogleSheetsAPI();
      } else {
        // The Google Sheets API client is not ready.
        console.log("Error: The Google Sheets API client is not ready.");
      }
    };
  </script>
</head>
<body>
  <p>This code will fix the error `Uncaught TypeError: Cannot read properties of undefined (reading 'spreadsheets')`. To use it, simply replace the `YOUR_SPREADSHEET_ID` placeholder with the ID of your Google Sheet.</p>
</body>
</html>
