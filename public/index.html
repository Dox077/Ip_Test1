
<!DOCTYPE html>
<html>
<head>
    <title>IP Tracker</title>
</head>
<body>
    <h1>IP Tracker</h1>
    <button onclick="saveIPAddress()">Save IP Address</button>

    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        // Replace with your API key
        const API_KEY = '';

        // Client ID and API key from the Developer Console
        const CLIENT_ID = '1023049278699-489s2oqrr75au1a0e214hjvtqr99kfbk.apps.googleusercontent.com';

        // Array of API discovery doc URLs for APIs used by the application
        const DISCOVERY_DOCS = ['https://sheets.googleapis.com/$discovery/rest?version=v4'];

        // Authorization scopes required by the API
        const SCOPES = 'https://www.googleapis.com/auth/spreadsheets';

        // Google Sheets spreadsheet ID and range
        const SPREADSHEET_ID = '1UDDarsUSFfdEhALQUlPvONklLpR0jzeV5kTaJ6Nslr4';
        const RANGE = 'Sheet1';

        function handleClientLoad() {
            gapi.load('client:auth2', initClient);
        }

        function initClient() {
            gapi.client.init({
                apiKey: API_KEY,
                clientId: CLIENT_ID,
                discoveryDocs: DISCOVERY_DOCS,
                scope: SCOPES
            }).then(function() {
                // Listen for sign-in state changes.
                gapi.auth2.getAuthInstance().isSignedIn.listen(updateSigninStatus);

                // Handle the initial sign-in state.
                updateSigninStatus(gapi.auth2.getAuthInstance().isSignedIn.get());
            });
        }

        function updateSigninStatus(isSignedIn) {
            if (isSignedIn) {
                console.log("User is signed in.");
            } else {
                console.log("User is not signed in.");
            }
        }

        function handleAuthClick() {
            gapi.auth2.getAuthInstance().signIn();
        }

        function handleSignoutClick() {
            gapi.auth2.getAuthInstance().signOut();
        }

        async function getIPAddress() {
            const response = await fetch('https://api64.ipify.org?format=json');
            const data = await response.json();
            return data.ip;
        }

        async function saveIPAddress() {
            const ipAddress = await getIPAddress();
            gapi.client.sheets.spreadsheets.values.append({
                spreadsheetId: SPREADSHEET_ID,
                range: RANGE,
                valueInputOption: 'RAW',
                insertDataOption: 'INSERT_ROWS',
                resource: {
                    values: [[ipAddress]]
                }
            }).then((response) => {
                console.log(`${response.result.updates.updatedCells} cells appended.`);
            }, (error) => {
                console.error('Error appending data: ', error);
            });
        }
    </script>
    <script src="https://apis.google.com/js/client.js?onload=handleClientLoad"></script>
</body>
</html>