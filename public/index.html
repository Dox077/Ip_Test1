<!DOCTYPE html>
<html>
<head>
  <title>Get IP Address and Save to Google Sheet</title>
</head>
<body>
  <h1>Get IP Address and Save to Google Sheet</h1>
  <button onclick="saveIPAddress()">Save IP Address</button>
  <script src="https://apis.google.com/js/api.js"></script>
  <script>
    // Load the Google Sheets API library
    gapi.load('client', initClient);

    // Set up the authentication credentials
    function initClient() {
      gapi.client.init({
        apiKey: 'AIzaSyA-hcANdJmipBAeDxGO7A7I2Xao5xex0XE',
        clientId: '1023049278699-489s2oqrr75au1a0e214hjvtqr99kfbk.apps.googleusercontent.com',
        discoveryDocs: ['https://sheets.googleapis.com/$discovery/rest?version=v4'],
        scope: 'https://www.googleapis.com/auth/spreadsheets',
      }).then(() => {
    console.log('Google Sheets API initialized.');
    // Authenticate the user and obtain an access token
    gapi.auth2.getAuthInstance().signIn().then(() => {
      console.log('User authenticated.');
    }, (error) => {
      console.error('Error authenticating user:', error);
    });
  }, (error) => {
    console.error('Error initializing Google Sheets API:', error);
  });
    }

    // Get the IP address of the user
    async function getIPAddress() {
      const response = await fetch('https://api.ipify.org?format=json');
      const data = await response.json();
      return data.ip;
    }

    // Save the IP address to a Google Sheet
    async function saveIPAddress() {
  const ipAddress = await getIPAddress();
  const spreadsheetId = '1UDDarsUSFfdEhALQUlPvONklLpR0jzeV5kTaJ6Nslr4';
  const range = 'Sheet1!A1';
  const valueInputOption = 'USER_ENTERED';
  const resource = {
    values: [[ipAddress]],
  };
  const accessToken = gapi.auth2.getAuthInstance().currentUser.get().getAuthResponse().access_token;
  const headers = new Headers();
  headers.append('Authorization', `Bearer ${accessToken}`);
  const response = await fetch(`https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${range}?valueInputOption=${valueInputOption}`, {
    method: 'PUT',
    headers,
    body: JSON.stringify(resource),
  });
  const data = await response.json();
  console.log(`${data.updatedCells} cells updated.`);
}
    
  </script>
</body>
</html>



<!-- // quke api  -->




